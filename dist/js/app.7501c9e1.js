(function(t){function e(e){for(var r,n,o=e[0],l=e[1],c=e[2],u=0,d=[];u<o.length;u++)n=o[u],i[n]&&d.push(i[n][0]),i[n]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r]);h&&h(e);while(d.length)d.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],r=!0,n=1;n<a.length;n++){var l=a[n];0!==i[l]&&(r=!1)}r&&(s.splice(e--,1),t=o(o.s=a[0]))}return t}var r={},i={app:0},s=[];function n(t){return o.p+"js/"+({about:"about"}[t]||t)+"."+{about:"d82ae8a8"}[t]+".js"}function o(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.e=function(t){var e=[],a=i[t];if(0!==a)if(a)e.push(a[2]);else{var r=new Promise(function(e,r){a=i[t]=[e,r]});e.push(a[2]=r);var s,l=document.createElement("script");l.charset="utf-8",l.timeout=120,o.nc&&l.setAttribute("nonce",o.nc),l.src=n(t),s=function(e){l.onerror=l.onload=null,clearTimeout(c);var a=i[t];if(0!==a){if(a){var r=e&&("load"===e.type?"missing":e.type),s=e&&e.target&&e.target.src,n=new Error("Loading chunk "+t+" failed.\n("+r+": "+s+")");n.type=r,n.request=s,a[1](n)}i[t]=void 0}};var c=setTimeout(function(){s({type:"timeout",target:l})},12e4);l.onerror=l.onload=s,document.head.appendChild(l)}return Promise.all(e)},o.m=t,o.c=r,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(a,r,function(e){return t[e]}.bind(null,r));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=e,l=l.slice();for(var u=0;u<l.length;u++)e(l[u]);var h=c;s.push([1,"chunk-vendors"]),a()})({0:function(t,e){},"034f":function(t,e,a){"use strict";var r=a("64a9"),i=a.n(r);i.a},"0889":function(t,e,a){"use strict";var r=a("198c"),i=a.n(r);i.a},"0fdc":function(t,e,a){},1:function(t,e,a){t.exports=a("56d7")},1352:function(t,e,a){"use strict";var r=a("6860"),i=a.n(r);i.a},"198c":function(t,e,a){},2:function(t,e){},"26e6":function(t,e,a){"use strict";var r=a("0fdc"),i=a.n(r);i.a},3:function(t,e){},"37bd":function(t,e,a){"use strict";var r=a("fec0"),i=a.n(r);i.a},"3b3e":function(t,e,a){t.exports=a.p+"img/head.6b711b64.jpg"},4805:function(t,e,a){"use strict";var r=a("897e"),i=a.n(r);i.a},"49bf":function(t,e,a){"use strict";var r=a("f0d5"),i=a.n(r);i.a},"51e2":function(t,e,a){"use strict";var r=a("8d36"),i=a.n(r);i.a},5378:function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);var r=a("795b"),i=a.n(r),s=a("f499"),n=a.n(s),o=a("5d73"),l=a.n(o),c=a("2d7d"),u=a.n(c),h=(a("28a5"),a("cadf"),a("551c"),a("097d"),a("2b0e")),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},p=[],m=(a("034f"),a("2877")),v={},f=Object(m["a"])(v,d,p,!1,null,null,null),g=f.exports,b=a("8c4f"),C=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"home"},[r("img",{attrs:{alt:"Vue logo",src:a("cf05")}}),r("HelloWorld",{attrs:{msg:"Welcome to Your Vue.js App"}})],1)},y=[],w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hello"},[a("h1",[t._v(t._s(t.msg))]),t._m(0),a("h3",[t._v("Installed CLI Plugins")]),t._m(1),a("h3",[t._v("Essential Links")]),t._m(2),a("h3",[t._v("Ecosystem")]),t._m(3)])},A=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[t._v("\n    For a guide and recipes on how to configure / customize this project,"),a("br"),t._v("\n    check out the\n    "),a("a",{attrs:{href:"https://cli.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("vue-cli documentation")]),t._v(".\n  ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-babel",target:"_blank",rel:"noopener"}},[t._v("babel")])]),a("li",[a("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-eslint",target:"_blank",rel:"noopener"}},[t._v("eslint")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[a("a",{attrs:{href:"https://vuejs.org",target:"_blank",rel:"noopener"}},[t._v("Core Docs")])]),a("li",[a("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("Forum")])]),a("li",[a("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("Community Chat")])]),a("li",[a("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank",rel:"noopener"}},[t._v("Twitter")])]),a("li",[a("a",{attrs:{href:"https://news.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("News")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[a("a",{attrs:{href:"https://router.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("vue-router")])]),a("li",[a("a",{attrs:{href:"https://vuex.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("vuex")])]),a("li",[a("a",{attrs:{href:"https://github.com/vuejs/vue-devtools#vue-devtools",target:"_blank",rel:"noopener"}},[t._v("vue-devtools")])]),a("li",[a("a",{attrs:{href:"https://vue-loader.vuejs.org",target:"_blank",rel:"noopener"}},[t._v("vue-loader")])]),a("li",[a("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank",rel:"noopener"}},[t._v("awesome-vue")])])])}],S={name:"HelloWorld",props:{msg:String}},x=S,F=(a("4805"),Object(m["a"])(x,w,A,!1,null,"b9167eee",null)),T=F.exports,_={name:"home",components:{HelloWorld:T}},L=_,j=Object(m["a"])(L,C,y,!1,null,null,null),k=j.exports,O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"enter-container"},[a("div",{staticClass:"logo"}),a("p",{staticClass:"slogan"},[t._v("—— 财务报表在线可视化工具")]),a("router-link",{staticClass:"route",attrs:{to:"/HomePage"}},[a("button",{staticClass:"enter-button"},[t._v("开始使用")])])],1),a("div",{staticClass:"coin coin1",class:1===t.animationStatus?"coin1-animation":"",on:{animationend:t.nextAnimation}}),a("div",{staticClass:"coin coin2",class:2===t.animationStatus?"coin2-animation":"",on:{animationend:t.nextAnimation}}),a("div",{staticClass:"coin coin3",class:3===t.animationStatus?"coin3-animation":"",on:{animationend:t.nextAnimation}}),a("p",{staticClass:"copyright-font"},[t._v("©️ Quanta Center 2019")])])},P=[],D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"loading-com"},[a("div",{staticClass:"circle circle1",style:{backgroundColor:t.background}}),a("div",{staticClass:"circle circle2",style:{backgroundColor:t.background}}),a("div",{staticClass:"circle circle3",style:{backgroundColor:t.background}})])},N=[],$={name:"loading-com",props:{background:String}},M=$,E=(a("bc11"),Object(m["a"])(M,D,N,!1,null,"49ccb43a",null)),G=E.exports,B={name:"login-page",components:{LoadingCom:G},data:function(){return{usernameStatus:1,usernameTip:"账号",passwordStatus:1,passwordTip:"密码",inputUsername:"",inputPassword:"",animationStatus:1,isLoading:!1}},methods:{enter:function(){},loginFunction:function(){var t=this,e=/^\w{6,15}$/;!this.isLoading&&e.test(this.inputUsername)?e.test(this.inputPassword)?(this.isLoading=!0,this.$axios.post("/login_view/",{username:this.inputUsername,password:this.inputPassword}).then(function(e){t.isLoading=!1}).catch(function(t){})):(this.passwordStatus=0,this.passwordTip="请输入6-15位密码，匹配字母数字_"):(this.usernameStatus=0,this.usernameTip="请输入6-15位账号，匹配字母数字_")},nextAnimation:function(){this.animationStatus=this.animationStatus%3+1}}},I=B,z=(a("ca17"),Object(m["a"])(I,O,P,!1,null,"9c9d8968",null)),H=z.exports,W=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"left",style:{width:t.leftStyleObj.width+"%",display:t.leftStyleObj.display}},[a("side-bar-com",{attrs:{paramALArray:t.paramSheetsArray.ALArray,paramPFArray:t.paramSheetsArray.PFArray,paramCFArray:t.paramSheetsArray.CFArray},on:{"left-slide":t.leftSlide,"show-up-load":t.showUpLoad,"change-table":t.changeTable,"judge-tables-group":t.judgeTablesGroup}})],1),a("div",{staticClass:"middle"},[a("up-bar-com"),a("chart-container-com",{attrs:{"home-page-side":t.leftStyleObj.flag,"sheet-data":t.paramDataSets}})],1),a("div",{staticClass:"right"},[a("right-side-bar-com")],1),t.isShowUpLoad?a("up-load-sheet-com",{on:{"show-up-load":t.showUpLoad,"collect-data":t.collectData}}):t._e()],1)},U=[],X=(a("7f7f"),a("a481"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"side-bar-com"},[a("div",{staticClass:"side-bar"},[a("button",{staticClass:"upload-btn",style:{opacity:t.sideBarOpacity?1:0},on:{click:t.showUpLoad}},[a("span",{staticClass:"upload-icon"}),a("span",[t._v("上传表格")])]),a("GeminiScrollbar",{staticClass:"scroll",style:{opacity:t.sideBarOpacity?1:0}},[a("div",{staticClass:"table-list-container"},[a("p",{staticClass:"table-list-title"},[a("span",{class:t.ALToggle?"down-triangle":"right-triangle",on:{click:t.ALHandle}}),a("span",{class:["ALGroup"===t.lastGroup?"selected-color":""],attrs:{"data-group":"ALGroup","data-index":"-1","data-title":"资产负债表汇总"},on:{click:t.changeTable}},[t._v("资产负债表")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.ALToggle,expression:"ALToggle"}],staticClass:"table-list"},t._l(t.ALArray,function(e,r){return a("p",{class:[e.selected?"selected-color":""],attrs:{"data-title":e.title,"data-index":r,"data-group":e.group},on:{click:function(e){t.changeTable(e)}}},[t._v("\n                            "+t._s(e.title)+"\n                        ")])}),0)]),a("div",{staticClass:"table-list-container"},[a("p",{staticClass:"table-list-title"},[a("span",{class:t.PFToggle?"down-triangle":"right-triangle",on:{click:t.PFHandle}}),a("span",{class:["PFGroup"===t.lastGroup?"selected-color":""],attrs:{"data-group":"PFGroup","data-index":"-1","data-title":"利润表（损益表）汇总"},on:{click:t.changeTable}},[t._v("利润表（损益表）")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.PFToggle,expression:"PFToggle"}],staticClass:"table-list"},t._l(t.PFArray,function(e,r){return a("p",{class:[e.selected?"selected-color":""],attrs:{"data-title":e.title,"data-index":r,"data-group":e.group},on:{click:function(e){t.changeTable(e)}}},[t._v("\n                            "+t._s(e.title)+"\n                        ")])}),0)]),a("div",{staticClass:"table-list-container"},[a("p",{staticClass:"table-list-title"},[a("span",{class:t.CFToggle?"down-triangle":"right-triangle",on:{click:t.CFHandle}}),a("span",{class:["CFGroup"===t.lastGroup?"selected-color":""],attrs:{"data-group":"CFGroup","data-index":"-1","data-title":"现金流量表汇总"},on:{click:t.changeTable}},[t._v("现金流量表")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.CFToggle,expression:"CFToggle"}],staticClass:"table-list"},t._l(t.CFArray,function(e,r){return a("p",{class:[e.selected?"selected-color":""],attrs:{"data-title":e.title,"data-index":r,"data-group":e.group},on:{click:function(e){t.changeTable(e)}}},[t._v("\n                            "+t._s(e.title)+"\n                        ")])}),0)])])],1),a("div",{staticClass:"toggle-container",style:{transform:"translate("+t.toggleObj.translateX+"%, -50%)"},on:{click:t.slide}},[a("div",{staticClass:"toggle-btn",class:[t.toggleObj.isPush?"toggle-push-btn":"toggle-pull-btn"]})]),a("div",{staticClass:"fill"})])}),R=[],J=a("e814"),q=a.n(J),V=a("682a"),Z=a.n(V),K={name:"side-bar-com",props:{paramALArray:Array,paramPFArray:Array,paramCFArray:Array},data:function(){return{test:this.props,ALArray:this.paramALArray,ALToggle:!0,PFArray:this.paramPFArray,PFToggle:!0,CFArray:this.paramCFArray,CFToggle:!0,lastGroup:"ALGroup",lastIndex:null,sideBarOpacity:!0,toggleObj:{translateX:0,isPush:!0}}},methods:{changeTable:function(t){var e=t.target.getAttribute("data-title"),a=t.target.getAttribute("data-group"),r=q()(t.target.getAttribute("data-index")),i=this.lastGroup,s=this.lastIndex;if(null!==s&&-1!==s){var n=this[i][s];n.selected=!1,h["default"].set(this[i],s,n)}if(-1!==r){var o=this[a][r];o.selected=!0,h["default"].set(this[a],r,o)}this.lastIndex=r,this.lastGroup=a,this.$emit("change-table",e,a),this.$emit("judge-tables-group",r)},ALHandle:function(){this.ALToggle=!this.ALToggle},PFHandle:function(){this.PFToggle=!this.PFToggle},CFHandle:function(){this.CFToggle=!this.CFToggle},slide:function(){function t(){Z.a.update()&&requestAnimationFrame(t)}this.sideBarOpacity=!this.sideBarOpacity,this.$emit("left-slide");var e=new Z.a.Tween(this.toggleObj);!1===this.sideBarOpacity?e.to({translateX:30},100):e.to({translateX:0},100),e.start(),t(),this.toggleObj.isPush=!this.toggleObj.isPush},showUpLoad:function(){this.$emit("show-up-load")}}},Q=K,Y=(a("bf3c"),Object(m["a"])(Q,X,R,!1,null,"790558ab",null)),tt=Y.exports,et=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"up-bar-com"},[r("div",{staticClass:"head-container"},[r("div",{staticClass:"information-container"},[r("img",{staticClass:"head-img",attrs:{src:a("3b3e")}}),r("span",{staticClass:"user-name"},[t._v(t._s(t.username))]),r("span",{staticClass:"down-triangle"})])])])},at=[],rt={name:"up-bar-com",data:function(){return{username:"用户名"}}},it=rt,st=(a("51e2"),Object(m["a"])(it,et,at,!1,null,"02f1f9f4",null)),nt=st.exports,ot=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"chart-container-com"}},[a("div",{staticClass:"head"},[a("p",{staticClass:"head-title"},[t._v(t._s(t.sheetData.title))]),a("div",{staticClass:"option-container"},[a("div",{staticClass:"option",on:{click:t.showCreateChart}},[a("span",{staticClass:"add-icon"}),a("span",[t._v("生成图表")])]),t._m(0)])]),a("div",{staticClass:"chart-container",style:{height:t.chartContainerHeight+"px"},on:{click:t.checkChart}},[t._l(t.chartArray,function(e,r){return a("div",{staticClass:"chart"},[a("button",{staticClass:"check-btn",attrs:{"data-btn-index":r}},[t._v("放大")]),a("chart-com",{attrs:{"resize-chart":t.resizeChart,"param-width":"100%","param-height":"100%","echart-option":e}})],1)}),a("div",{staticClass:"occupy-div"})],2),t.isShowCreateChart?a("create-chart-com",{attrs:{"sheet-data":t.sheetData},on:{"show-create-chart":t.showCreateChart}}):t._e(),t.isShowCheckChart?a("check-chart-com",{attrs:{"echart-option":t.echartOption},on:{"show-check-chart":t.showCheckChart}}):t._e()],1)},lt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"option"},[a("span",{staticClass:"export-icon"}),a("span",[t._v("多选导出")])])}],ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"create-chart-com"},[a("div",{staticClass:"create-chart-div"},[a("div",{staticClass:"head"},[a("button",{staticClass:"close-btn",on:{click:t.close}},[t._v("X")]),a("button",{staticClass:"confirm-btn",on:{click:t.confirmOption}},[t._v("确认生成")])]),a("div",{staticClass:"main"},[a("div",{staticClass:"left"},[a("option-com",{staticClass:"option-com",attrs:{"param-option-array":t.chartOptionArray},on:{"get-chart-option":t.getChartOption}}),a("chart-com",{staticClass:"chart-com",attrs:{"param-width":"620px","param-height":"450px","echart-option":t.echartOption}})],1),a("div",{staticClass:"right"},[a("div",{staticClass:"choose-subject"},[a("button",{class:[t.selectSubject?"selected-subject-btn":"unselected-subject-btn"],on:{click:t.chooseSubjects}},[t._v("选择科目\n                    ")]),"group"===t.sheetData.type?a("button",{class:[t.selectSubject?"unselected-subject-btn":"selected-subject-btn"],on:{click:t.chooseTables}},[t._v("筛选表格\n                    ")]):t._e()]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.selectSubject,expression:"selectSubject"}],staticClass:"subject-container"},[a("menu-com",{staticClass:"menu-com",attrs:{"param-choices-array":t.subjectArray,title:"可选科目"},on:{"get-subject":t.getData}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.selectSubject,expression:"!selectSubject"}],staticClass:"sheets-container",on:{click:t.sheetArrayChange}},t._l(t.sheetArray,function(e,r){return a("div",{staticClass:"sheet-unit"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.selected,expression:"sheet.selected"}],attrs:{"data-sheet-name":e.sheetName,type:"checkbox",id:"sheet-unit-"+r},domProps:{checked:Array.isArray(e.selected)?t._i(e.selected,null)>-1:e.selected},on:{change:function(a){var r=e.selected,i=a.target,s=!!i.checked;if(Array.isArray(r)){var n=null,o=t._i(r,n);i.checked?o<0&&t.$set(e,"selected",r.concat([n])):o>-1&&t.$set(e,"selected",r.slice(0,o).concat(r.slice(o+1)))}else t.$set(e,"selected",s)}}}),a("label",{attrs:{for:"sheet-unit-"+r}},[a("span",[t._v(t._s(e.sheetName))])])])}),0)])])])])},ut=[],ht=(a("6c7b"),a("768b")),dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"menu-com"},[a("button",{staticClass:"menu-btn",class:!0===t.menuBtnToggle?"menu-btn-on":"",on:{click:t.controlMenu}},[a("span",[t._v(t._s(t.title))]),a("span",{class:!0===t.menuBtnToggle?"triangle-down":"triangle-right"})]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.menuBtnToggle,expression:"menuBtnToggle"}],staticClass:"subjects-container",on:{click:t.getChoices}},t._l(t.choicesArray,function(e,r){return a("button",{class:!0===e.selected?"selected-btn":"unselected-btn",attrs:{"data-index":r}},[t._v("\n            "+t._s(e.name)+"\n        ")])}),0)])},pt=[],mt={name:"menu-com",props:{paramChoicesArray:Array,title:String},data:function(){return{menuBtnToggle:!0,choicesArray:this.paramChoicesArray,selectedMap:new u.a}},watch:{paramChoicesArray:function(t,e){this.choicesArray=t}},methods:{controlMenu:function(){this.menuBtnToggle=!this.menuBtnToggle},getChoices:function(t){var e=t.target;if(null!==e.getAttribute("data-index")){var a=~~e.getAttribute("data-index");this.choicesArray[a].selected=!this.choicesArray[a].selected;var r=e.innerText;this.$emit("get-subject",r)}}},mounted:function(){}},vt=mt,ft=(a("6e6e"),Object(m["a"])(vt,dt,pt,!1,null,"7d542dbd",null)),gt=ft.exports,bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:{width:t.paramWidth,height:t.paramHeight},attrs:{id:t.randomId}})},Ct=[],yt=(a("6b54"),{name:"chart-com",props:{paramWidth:"",paramHeight:"",echartOption:null,resizeChart:Boolean},data:function(){return{chart:null}},computed:{randomId:function(){return"chart-com"+Math.random().toString()}},methods:{draw:function(t){
//!ID重复问题！
var e=document.getElementById(this.randomId.toString()),a=this.$echarts.init(e,"Cat");a.clear(),a.setOption(t),this.chart=a},resize:function(){this.chart.resize()}},watch:{echartOption:function(t,e){this.draw(t)},resizeChart:function(t,e){this.resize()}},mounted:function(){null!==this.echartOption&&this.draw(this.echartOption)}}),wt=yt,At=Object(m["a"])(wt,bt,Ct,!1,null,"1ca7c09c",null),St=At.exports,xt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"option-com",on:{click:t.getChoices}},t._l(t.chartOptionArray,function(e,r){return a("button",{staticClass:"option-btn",class:t.selectedIndex===r?"selected-option":"unselected-option",attrs:{"data-index":r}},[t._v(t._s(e))])}),0)},Ft=[],Tt={name:"option-com",props:{paramOptionArray:Array},data:function(){return{chartOptionArray:this.paramOptionArray,selectedIndex:0}},methods:{getChoices:function(t){var e=t.target;if(null!==e.getAttribute("data-index")){var a=~~e.getAttribute("data-index");if(a===this.selectedIndex)this.selectedIndex=-1,this.$emit("get-chart-option",null);else{this.selectedIndex=a;var r=e.innerText;this.$emit("get-chart-option",r)}}}}},_t=Tt,Lt=(a("1352"),Object(m["a"])(_t,xt,Ft,!1,null,"da669d12",null)),jt=Lt.exports,kt={name:"create-chart-com",components:{MenuCom:gt,ChartCom:St,OptionCom:jt},props:{sheetData:Object},data:function(){return{chartOptionArray:["柱形","饼状","折线+饼图","雷达图","正负轴"],chartOption:"柱形",subjectMap:new u.a,echartOption:null,subjectArray:new Array,sheetArray:[],selectSubject:!0}},watch:{},methods:{getData:function(t){var e=this,a=new u.a,r=null,i=null;if("table"===this.sheetData.type){var s=this.globalData.sheetsData[this.sheetData.group],n=s.get(this.sheetData.title);r=n.timeField1,i=n.timeField2;var o=this.getDataFromArray(t,n.dataSets,n.sheetTime);a.set(t,o);var c=!0,h=!1,d=void 0;try{for(var p,m=l()(a);!(c=(p=m.next()).done);c=!0){var v=Object(ht["a"])(p.value,2),f=v[0],g=v[1];this.subjectMap.has(f)?this.subjectMap.delete(f):this.subjectMap.set(f,g)}}catch(A){h=!0,d=A}finally{try{c||null==m.return||m.return()}finally{if(h)throw d}}this.createEchartOption(this.chartOption,this.subjectMap,r,i)}else if("group"===this.sheetData.type){if(0===this.selectedArray.length)return this.subjectMap.has(t)?this.subjectMap.delete(t):this.subjectMap.set(t,[null,null,null,t]),void(this.echartOption=new Object);var b=this.getAllSubjectMap(this.subjectMap);b.has(t)?b.delete(t):b.set(t,!0);var C=this.globalData.sheetsData[this.sheetData.group.replace(/Group/,"Map")],y=this.getTimeFieldInGroup(C),w=Object(ht["a"])(y,2);r=w[0],i=w[1],this.getTempSubjectMapInGroup(b,C).then(function(t){e.subjectMap=t,e.createEchartOption(e.chartOption,e.subjectMap,r,i)})}},createEchartOption:function(t,e,a,r){var i=null;switch(t){case"柱形":i=s(e,a,r);break;case"饼状":i=n(e,a,r);break;case"折线+饼图":i=o(e,a,r);break;case"雷达图":i=c(e,a,r);break;case"正负轴":i=h(e,a,r);break}function s(t,e,a){var r=["timeField"],i=[{timeField:e},{timeField:a}],s=!0,n=!1,o=void 0;try{for(var c,u=l()(t);!(s=(c=u.next()).done);s=!0){var h=Object(ht["a"])(c.value,2),d=h[0],p=h[1];r.push(d),i[0][d]=p[0],i[1][d]=p[1]}}catch(b){n=!0,o=b}finally{try{s||null==u.return||u.return()}finally{if(n)throw o}}for(var m=r.length-1,v=[],f=0;f<m;f++)v.push({type:"bar"});var g={legend:{},tooltip:{},dataset:{dimensions:r,source:i},series:v,xAxis:{type:"category"},yAxis:{},grid:{left:"15%"}};return g}function n(t,e,a){var r=[],i=[],s=!0,n=!1,o=void 0;try{for(var c,u=l()(t);!(s=(c=u.next()).done);s=!0){var h=Object(ht["a"])(c.value,2),d=h[0],p=h[1];r.push({name:d,value:p[0]}),i.push({name:d,value:p[1]})}}catch(v){n=!0,o=v}finally{try{s||null==u.return||u.return()}finally{if(n)throw o}}var m={title:[{text:e,left:"25%",bottom:"15%"},{text:a,left:"73%",bottom:"15%"}],legend:{type:"scroll",top:30},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},series:[{name:e,type:"pie",roseType:"radius",radius:"40%",center:["30%","50%"],data:r,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},{name:a,type:"pie",roseType:"radius",radius:"40%",center:["75%","50%"],data:i,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};return m}function o(t,e,a){var r={},i=[],s=[];i.push(["subject",e,a]);var n=!0,o=!1,c=void 0;try{for(var u,h=l()(t);!(n=(u=h.next()).done);n=!0){var d=Object(ht["a"])(u.value,2),p=d[0],m=d[1];i.push([p,m[0],m[1]])}}catch(v){o=!0,c=v}finally{try{n||null==h.return||h.return()}finally{if(o)throw c}}return s=new Array(i.length-1).fill({type:"line",smooth:!0,seriesLayoutBy:"row"}),s.push({type:"pie",id:"pie",radius:"30%",center:["50%","25%"],label:{formatter:"{b}({d}%)"},encode:{itemName:"subject",value:e,tooltip:e}}),r={legend:{},tooltip:{trigger:"axis",showContent:!0},dataset:{source:i},title:{},xAxis:{type:"category"},yAxis:{gridIndex:0},grid:{top:"55%",left:"15%"},series:s},r}function c(t,e,a){var r={},i=new u.a,s=-1,n=!0,o=!1,c=void 0;try{for(var h,d=l()(t);!(n=(h=d.next()).done);n=!0){var p=Object(ht["a"])(h.value,2),m=p[0],v=p[1],f=v[0]>v[1]?v[0]:v[1];s=s>f?s:f,i.has(v[2]+"初")||(i.set(v[2]+"初",new u.a),i.set(v[2]+"末",new u.a));var g=i.get(v[2]+"初"),b=i.get(v[2]+"末");g.set(m,v[0]),b.set(m,v[1])}}catch(W){o=!0,c=W}finally{try{n||null==d.return||d.return()}finally{if(o)throw c}}var C={},y=[],w=[];C.indicator=[];var A=!0,S=!1,x=void 0;try{for(var F,T=l()(t);!(A=(F=T.next()).done);A=!0){var _=Object(ht["a"])(F.value,2);m=_[0],v=_[1];C.indicator.push({text:m,max:s})}}catch(W){S=!0,x=W}finally{try{A||null==T.return||T.return()}finally{if(S)throw x}}var L=!0,j=!1,k=void 0;try{for(var O,P=l()(i);!(L=(O=P.next()).done);L=!0){var D=Object(ht["a"])(O.value,2),N=(m=D[0],D[1]);w.push({type:"radar",symbol:"none",lineStyle:{width:1},emphasis:{areaStyle:{color:"rgba(0,250,0,0.3)"}},data:[{name:m,value:[]}]});var $=w[w.length-1],M=$.data[0].value,E=!0,G=!1,B=void 0;try{for(var I,z=l()(N);!(E=(I=z.next()).done);E=!0){var H=Object(ht["a"])(I.value,2);H[0],v=H[1];M.push(v)}}catch(W){G=!0,B=W}finally{try{E||null==z.return||z.return()}finally{if(G)throw B}}y.push(m)}}catch(W){j=!0,k=W}finally{try{L||null==P.return||P.return()}finally{if(j)throw k}}return r={title:{},tooltip:{trigger:"item",backgroundColor:"rgba(0,0,250,0.2)"},visualMap:{top:"middle",right:10,max:s,min:0,color:["red","yellow"],calculable:!0},radar:C,legend:{type:"scroll",bottom:10,data:y},series:w},r}function h(t,e,a){var r=[],i=[],s=[],n=new u.a,o=new u.a,c=!0,h=!1,d=void 0;try{for(var p,m=l()(t);!(c=(p=m.next()).done);c=!0){var v=Object(ht["a"])(p.value,2),f=v[0],g=v[1];n.has(g[3])?n.get(g[3]).set(g[2],g[1]-g[0]):(n.set(g[3],new u.a),n.get(g[3]).set(g[2],g[1]-g[0])),!o.has(g[2])&&o.set(g[2],!0)}}catch(z){h=!0,d=z}finally{try{c||null==m.return||m.return()}finally{if(h)throw d}}var b=!0,C=!1,y=void 0;try{for(var w,A=l()(o);!(b=(w=A.next()).done);b=!0){var S=Object(ht["a"])(w.value,2),x=S[0];g=S[1];i.push(x)}}catch(z){C=!0,y=z}finally{try{b||null==A.return||A.return()}finally{if(C)throw y}}var F=!0,T=!1,_=void 0;try{for(var L,j=l()(n);!(F=(L=j.next()).done);F=!0){var k=Object(ht["a"])(L.value,2),O=(f=k[0],k[1]);s.push({name:f,type:"bar",label:{normal:{show:!0}},data:[]}),r.push(f);var P=s[s.length-1].data,D=!0,N=!1,$=void 0;try{for(var M,E=l()(O);!(D=(M=E.next()).done);D=!0){var G=Object(ht["a"])(M.value,2),B=(G[0],G[1]);P.push(B)}}catch(z){N=!0,$=z}finally{try{D||null==E.return||E.return()}finally{if(N)throw $}}}}catch(z){T=!0,_=z}finally{try{F||null==j.return||j.return()}finally{if(T)throw _}}var I={title:{text:a+"-"+e},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:r},xAxis:[{type:"value"}],yAxis:[{type:"category",axisTick:{show:!1},data:i}],series:s};return I}this.echartOption=i},getGroupSubjectData:function(t,e,a){var r=[],i=new u.a,s=!0,n=!1,o=void 0;try{for(var c,h=l()(t);!(s=(c=h.next()).done);s=!0){var d=c.value;!0===d.selected&&r.push(d.sheetName)}}catch(b){n=!0,o=b}finally{try{s||null==h.return||h.return()}finally{if(n)throw o}}for(var p=0;p<r.length;p++){var m=r[p],v=e.get(m),f=v.sheetTime,g=this.getDataFromArray(a,v.dataSets,v.sheetTime);i.set(f+a,g)}return i},sheetArrayChange:function(t){var e=this,a=t.target.getAttribute("data-sheet-name");if(null!==a&&void 0!==a){var r=this.subjectMap,i=this.globalData.sheetsData[this.sheetData.group.replace(/Group/,"Map")],s=(i.get(a).sheetTime,null),n=null,o=this.getAllSubjectMap(r),l=this.getTimeFieldInGroup(i),c=Object(ht["a"])(l,2);s=c[0],n=c[1],this.getTempSubjectMapInGroup(o,i).then(function(t){e.subjectMap=t,0!==e.subjectMap.size&&e.createEchartOption(e.chartOption,e.subjectMap,s,n)})}},getChartOption:function(t){if(this.chartOption=t,0!==this.subjectMap.size){var e=null,a=null;if("table"===this.sheetData.type){var r=this.globalData.sheetsData[this.sheetData.group],i=r.get(this.sheetData.title);e=i.timeField1,a=i.timeField2}else if("group"===this.sheetData.type){var s=this.globalData.sheetsData[this.sheetData.group.replace(/Group/,"Map")],n=this.getTimeFieldInGroup(s),o=Object(ht["a"])(n,2);e=o[0],a=o[1]}this.createEchartOption(t,this.subjectMap,e,a)}},close:function(){this.$emit("show-create-chart")},getDataFromArray:function(t,e,a){var r=!0,i=!1,s=void 0;try{for(var n,o=l()(e);!(r=(n=o.next()).done);r=!0){var c=n.value;if(-1!==c.name.indexOf(t))return[c.value1,c.value2,a,t]}}catch(u){i=!0,s=u}finally{try{r||null==o.return||o.return()}finally{if(i)throw s}}return null},confirmOption:function(){var t=this.sheetData,e=this.echartOption;if(null!==e)if("table"===t.type){var a=this.globalData.sheetsData[t.group].get(t.title).charts;a.push(e)}else{var r=this.globalData.sheetsData[t.group];r.push(e)}this.$emit("show-create-chart")},chooseSubjects:function(){this.selectSubject=!0},chooseTables:function(){this.selectSubject=!1},getAllSubjectMap:function(t){var e=new u.a,a=!0,r=!1,i=void 0;try{for(var s,n=l()(t);!(a=(s=n.next()).done);a=!0){var o=Object(ht["a"])(s.value,2),c=(o[0],o[1]);e.has(c[3])||e.set(c[3],!0)}}catch(h){r=!0,i=h}finally{try{a||null==n.return||n.return()}finally{if(r)throw i}}return e},getTimeFieldInGroup:function(t){var e=null,a=null,r=!0,i=!1,s=void 0;try{for(var n,o=l()(t);!(r=(n=o.next()).done);r=!0){var c=Object(ht["a"])(n.value,2),u=(c[0],c[1]);if(null===e){e=u.timeField1,a=u.timeField2;break}}}catch(h){i=!0,s=h}finally{try{r||null==o.return||o.return()}finally{if(i)throw s}}return[e,a]},getTempSubjectMapInGroup:function(t,e){var a=this,r=new i.a(function(r,i){setTimeout(function(){var i=new u.a;if(0!==a.selectedArray.length){var s=!0,n=!1,o=void 0;try{for(var c,h=l()(t);!(s=(c=h.next()).done);s=!0){var d=Object(ht["a"])(c.value,2),p=d[0],m=(d[1],!0),v=!1,f=void 0;try{for(var g,b=l()(a.selectedArray);!(m=(g=b.next()).done);m=!0){var C=g.value,y=e.get(C),w=a.getDataFromArray(p,y.dataSets,y.sheetTime);i.set(y.sheetTime+p,w)}}catch(L){v=!0,f=L}finally{try{m||null==b.return||b.return()}finally{if(v)throw f}}}}catch(L){n=!0,o=L}finally{try{s||null==h.return||h.return()}finally{if(n)throw o}}}else{var A=!0,S=!1,x=void 0;try{for(var F,T=l()(t);!(A=(F=T.next()).done);A=!0){var _=Object(ht["a"])(F.value,2);p=_[0],_[1];i.set(p,[null,null,null,p])}}catch(L){S=!0,x=L}finally{try{A||null==T.return||T.return()}finally{if(S)throw x}}}r(i)},0)});return r},getTempSubjectMapByFun:function(t,e){var a=new u.a,r=[],i=!0,s=!1,n=void 0;try{for(var o,c=l()(this.sheetArray);!(i=(o=c.next()).done);i=!0){var h=o.value;!0===h.selected&&r.push(h.sheetName)}}catch(S){s=!0,n=S}finally{try{i||null==c.return||c.return()}finally{if(s)throw n}}var d=!0,p=!1,m=void 0;try{for(var v,f=l()(t);!(d=(v=f.next()).done);d=!0)for(var g=Object(ht["a"])(v.value,2),b=g[0],C=(g[1],0);C<r.length;C++){var y=r[C],w=e.get(y),A=this.getDataFromArray(b,w.dataSets,w.sheetTime);a.set(w.sheetTime+b,A)}}catch(S){p=!0,m=S}finally{try{d||null==f.return||f.return()}finally{if(p)throw m}}return a}},computed:{selectedArray:function(){var t=[],e=!0,a=!1,r=void 0;try{for(var i,s=l()(this.sheetArray);!(e=(i=s.next()).done);e=!0){var n=i.value;!0===n.selected&&t.push(n.sheetName)}}catch(o){a=!0,r=o}finally{try{e||null==s.return||s.return()}finally{if(a)throw r}}return t}},mounted:function(){var t=null,e=this.sheetData.group;if("group"===this.sheetData.type){var a=this.sheetData.group.replace(/Group/,"Map");e=this.sheetData.group.replace(/Group/,"Map");var r=this.globalData.sheetsData[a],i=!0,s=!1,n=void 0;try{for(var o,c=l()(r);!(i=(o=c.next()).done);i=!0){var u=Object(ht["a"])(o.value,2),h=u[0],d=u[1];this.sheetArray.push({sheetName:h,selected:!1,sheetTime:d.sheetTime})}}catch(w){s=!0,n=w}finally{try{i||null==c.return||c.return()}finally{if(s)throw n}}}try{t=this.sheetArray[0].sheetName}catch(A){t=this.sheetData.title}var p=this.globalData.sheetsData[e].get(t),m=[],v=!0,f=!1,g=void 0;try{for(var b,C=l()(p.dataSets);!(v=(b=C.next()).done);v=!0){var y=b.value;null!==y.value1&&null!==y.value2&&"-"!==y.value1&&"-"!==y.value2&&m.push({name:y.name,selected:!1})}}catch(w){f=!0,g=w}finally{try{v||null==C.return||C.return()}finally{if(f)throw g}}this.subjectArray=m}},Ot=kt,Pt=(a("f99f"),Object(m["a"])(Ot,ct,ut,!1,null,"0b164daf",null)),Dt=Pt.exports,Nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mask",on:{click:t.closeCheckChartCom}},[a("div",{staticClass:"chart-container"},[a("chart-com",{attrs:{"echart-option":t.echartOption,"param-width":"100%","param-height":"100%"}})],1)])},$t=[],Mt={name:"check-chart-com",components:{ChartCom:St},props:{echartOption:Object},methods:{closeCheckChartCom:function(t){"CANVAS"!==t.target.tagName&&this.$emit("show-check-chart")}},mounted:function(){}},Et=Mt,Gt=(a("37bd"),Object(m["a"])(Et,Nt,$t,!1,null,"2a24862f",null)),Bt=Gt.exports,It={name:"chart-container-com",components:{CreateChartCom:Dt,ChartCom:St,CheckChartCom:Bt},props:{sheetData:{title:"",type:"",group:""},homePageSide:Boolean},watch:{sheetData:function(t,e){var a=null;if("group"===t.type)a=this.globalData.sheetsData[t.group];else{var r=this.globalData.sheetsData[t.group].get(t.title);a=r.charts}this.chartArray=a},homePageSide:function(){this.resizeChart=!this.resizeChart}},data:function(){return{chartArray:[],isShowCreateChart:!1,chartContainerHeight:550,resizeChart:!1,canvasDom:null,echartOption:null,isShowCheckChart:!1}},methods:{checkChart:function(t){var e=t.target.getAttribute("data-btn-index"),a=null;if(null!==e&&void 0!==e){var r=q()(e);a="table"===this.sheetData.type?this.globalData.sheetsData[this.sheetData.group].get(this.sheetData.title).charts[r]:this.globalData.sheetsData[this.sheetData.group][r],this.echartOption=a,this.showCheckChart()}},showCreateChart:function(){this.isShowCreateChart=!this.isShowCreateChart},showCheckChart:function(){this.isShowCheckChart=!this.isShowCheckChart}},created:function(){var t=this;this.chartContainerHeight=window.innerHeight-190;var e=function(e){t.chartContainerHeight=window.innerHeight-190,t.resizeChart=!t.resizeChart};window.addEventListener("resize",e)}},zt=It,Ht=(a("26e6"),Object(m["a"])(zt,ot,lt,!1,null,"0279169b",null)),Wt=Ht.exports,Ut=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},Xt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"right-side-bar-com"},[a("button",{staticClass:"top-button"}),a("button",{staticClass:"choice-btn chart-unselected-icon"}),a("button",{staticClass:"choice-btn trash-unselected-icon"}),a("button",{staticClass:"choice-btn help-unselected-icon"})])}],Rt={name:"right-side-bar-com"},Jt=Rt,qt=(a("49bf"),Object(m["a"])(Jt,Ut,Xt,!1,null,"5994e50b",null)),Vt=qt.exports,Zt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.step,expression:"step === 1"}],staticClass:"up-load-div",on:{drop:t.handleDrop,dragover:function(t){t.preventDefault()}}},[a("p",{staticClass:"line drag-p"},[t._v("直接将文件拖拽到这里")]),a("p",{staticClass:"line or-p"},[t._v("或者")]),a("button",{staticClass:"choose-file-btn",on:{click:t.upLoad}},[t._v("选择文件")]),a("button",{staticClass:"close-btn",on:{click:t.close}},[t._v("X")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:2===t.step,expression:"step === 2"}],staticClass:"time-field-div"},[t._m(0),a("div",{staticClass:"field-input-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.customALSheetName,expression:"customALSheetName"}],staticClass:"input0",domProps:{value:t.customALSheetName},on:{input:function(e){e.target.composing||(t.customALSheetName=e.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.ALTime[0],expression:"ALTime[0]"}],staticClass:"input1",domProps:{value:t.ALTime[0]},on:{input:function(e){e.target.composing||t.$set(t.ALTime,0,e.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.ALTime[1],expression:"ALTime[1]"}],staticClass:"input2",domProps:{value:t.ALTime[1]},on:{input:function(e){e.target.composing||t.$set(t.ALTime,1,e.target.value)}}})]),a("div",{staticClass:"field-input-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.customPFSheetName,expression:"customPFSheetName"}],staticClass:"input0",domProps:{value:t.customPFSheetName},on:{input:function(e){e.target.composing||(t.customPFSheetName=e.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.PFTime[0],expression:"PFTime[0]"}],staticClass:"input1",domProps:{value:t.PFTime[0]},on:{input:function(e){e.target.composing||t.$set(t.PFTime,0,e.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.PFTime[1],expression:"PFTime[1]"}],staticClass:"input2",domProps:{value:t.PFTime[1]},on:{input:function(e){e.target.composing||t.$set(t.PFTime,1,e.target.value)}}})]),a("div",{staticClass:"field-input-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.customCFSheetName,expression:"customCFSheetName"}],staticClass:"input0",domProps:{value:t.customCFSheetName},on:{input:function(e){e.target.composing||(t.customCFSheetName=e.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.CFTime[0],expression:"CFTime[0]"}],staticClass:"input1",domProps:{value:t.CFTime[0]},on:{input:function(e){e.target.composing||t.$set(t.CFTime,0,e.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.CFTime[1],expression:"CFTime[1]"}],staticClass:"input2",domProps:{value:t.CFTime[1]},on:{input:function(e){e.target.composing||t.$set(t.CFTime,1,e.target.value)}}})]),a("div",{staticClass:"field-input-container inline-block-div"},[t._m(1),a("input",{directives:[{name:"model",rawName:"v-model",value:t.sheetTime,expression:"sheetTime"}],staticClass:"input1",domProps:{value:t.sheetTime},on:{input:function(e){e.target.composing||(t.sheetTime=e.target.value)}}}),a("button",{staticClass:"create-btn",on:{click:t.finishGetTime}},[t._v("完成")])]),a("button",{staticClass:"close-btn",on:{click:t.close}},[t._v("X")])])])},Kt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"time-field-container"},[a("div",{staticClass:"div0"},[a("p",[t._v("表名")]),a("div",{staticClass:"down-triangle"})]),a("div",{staticClass:"div1"},[a("p",[t._v("填写时间字段一")]),a("div",{staticClass:"down-triangle"})]),a("div",{staticClass:"div2"},[a("p",[t._v("填写时间字段二")]),a("div",{staticClass:"down-triangle"})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[a("span",[t._v("表时间")])])}],Qt=a("7618"),Yt=(a("34ef"),a("1146")),te=a.n(Yt),ee={name:"up-load-sheet-com",data:function(){return{workbook:null,paramSheetsArray:[],sheetTime:"",ALSheetName:null,customALSheetName:"",ALDataTable:[],recordALPosArray1:[],recordALPosArray2:[],ALColumnsLength:null,ALRowsLength:null,ALDataSets:[],ALTime:[null,null],PFSheetName:null,customPFSheetName:"",PFDataTable:[],recordPFPosArray1:[],recordPFPosArray2:[],PFColumnsLength:null,PFRowsLength:null,PFDataSets:[],PFTime:[null,null],CFSheetName:null,customCFSheetName:"",CFDataTable:[],recordCFPosArray1:[],recordCFPosArray2:[],CFColumnsLength:null,CFRowsLength:null,CFDataSets:[],CFTime:[null,null],step:1}},methods:{upLoad:function(){var t=document.createElement("input");t.type="file",t.onchange=this.handleFiles,t.click()},finishGetTime:function(){var t=this.workbook,e=this.ALSheetName,a=this.PFSheetName,r=this.CFSheetName,i=Object(ht["a"])(this.ALTime,2),s=i[0],n=i[1],o=Object(ht["a"])(this.PFTime,2),l=o[0],c=o[1],u=Object(ht["a"])(this.CFTime,2),h=u[0],d=u[1];try{this.parseALSheet(t,e,s,n)}catch(p){console.log(p)}try{this.parsePFSheet(t,a,l,c)}catch(p){console.log(p)}try{this.parseCFSheet(t,r,h,d)}catch(p){console.log(p)}this.$emit("collect-data",{name:this.sheetTime+this.customALSheetName,dataSets:this.ALDataSets,timeField1:s,timeField2:n,sheetTime:this.sheetTime},{name:this.sheetTime+this.customPFSheetName,dataSets:this.PFDataSets,timeField1:l,timeField2:c,sheetTime:this.sheetTime},{name:this.sheetTime+this.customCFSheetName,dataSets:this.CFDataSets,timeField1:h,timeField2:d,sheetTime:this.sheetTime}),this.close()},analysisFiles:function(t,e){var a=this,r=!1,i=null,s=null;"upload"===e?(i=t.target.files,s=i[0]):"drop"===e&&(i=t.dataTransfer.files,s=i[0]);var n=/^(.*)(\.)(\w*)$/,o=n.exec(s.name)[3].toLowerCase();if("xlsx"===o||"xls"===o){var l=new FileReader;l.onload=function(t){var e=t.target.result;!r&&(e=new Uint8Array(e));var i=te.a.read(e,{type:r?"binary":"array"});a.workbook=i,a.getSheetNames(i);for(var s=a.paramSheetsArray.length,n="资产负债",o="利润",l="现金",c=0;c<s;c++)"资产负债"!==n||-1===a.paramSheetsArray[c].indexOf(n)?"利润"!==o||-1===a.paramSheetsArray[c].indexOf(o)?"现金"!==l||-1===a.paramSheetsArray[c].indexOf(l)||(l=a.paramSheetsArray[c],a.CFSheetName=a.paramSheetsArray[c],a.customCFSheetName=a.paramSheetsArray[c]):(o=a.paramSheetsArray[c],a.PFSheetName=a.paramSheetsArray[c],a.customPFSheetName=a.paramSheetsArray[c]):(n=a.paramSheetsArray[c],a.ALSheetName=a.paramSheetsArray[c],a.customALSheetName=a.paramSheetsArray[c]);var h=a.workbook.Sheets[a.ALSheetName],d=a.workbook.Sheets[a.CFSheetName],p=a.workbook.Sheets[a.PFSheetName];function m(e){var a=new u.a,r=null,i=null,s=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O"];for(var n in e){var o=/^([A-Z])(\d+)$/;try{var l=o.exec(n)[1],c=q()(o.exec(n)[2]);!a.has(l)&&a.set(l,{minIndex:c,maxIndex:c});var h=a.get(l);c<h.minIndex&&(h.minIndex=c),c>h.maxIndex&&(h.maxIndex=c)}catch(t){}}for(var d=0;d<s.length;d++){var p=s[d],m=a.get(p);if(void 0===m)break;for(var v=3,f=0,g=10,b=m.minIndex;f<=v&&b<=m.maxIndex;b++){var C=p+b.toString();if(e.hasOwnProperty(C)){var y=e[C].v;"number"===typeof y&&y>500&&f++,"number"===typeof y&&b<g&&(g=b)}}if(f>v)for(var w=g;w>0;w--)try{var A=e[p+w.toString()].v,S=Object(Qt["a"])(A);if("number"!==S&&"-"!==A){if(null===r){r=A;break}if(null===i){i=A;break}}}catch(t){}if(null!==r&&null!==i)break}return[r,i]}a.ALTime=m(h),a.PFTime=m(p),a.CFTime=m(d)},r?l.readAsBinaryString(s):l.readAsArrayBuffer(s)}else alert("请上传后缀为.xlsx的excel表格");this.step=2},handleFiles:function(t){this.analysisFiles(t,"upload")},handleDrop:function(t){t.stopPropagation(),t.preventDefault(),this.analysisFiles(t,"drop")},parseALSheet:function(t,e,a,r){var i=t.Sheets[e],s=this.getSheetSize(i),n=s.columnsLength,o=s.rowsLength;this.ALColumnsLength=n,this.ALRowsLength=o;var l=this.getDataTable(i,n,o,a,r),c=l.dataTable,u=l.recordPosArray1,h=l.recordPosArray2;this.ALDataTable=c,this.recordALPosArray1=u,this.recordALPosArray2=h,this.ALDataSets=this.getDataSets(u,h,c,n,o)},parsePFSheet:function(t,e,a,r){var i=t.Sheets[e],s=this.getSheetSize(i),n=s.columnsLength,o=s.rowsLength;this.PFColumnsLength=n,this.PFRowsLength=o;var l=this.getDataTable(i,n,o,a,r),c=l.dataTable,u=l.recordPosArray1,h=l.recordPosArray2;this.PFDataTable=c,this.recordPFPosArray1=u,this.recordPFPosArray2=h,this.PFDataSets=this.getDataSets(u,h,c,n,o)},parseCFSheet:function(t,e,a,r){var i=t.Sheets[e],s=this.getSheetSize(i),n=s.columnsLength,o=s.rowsLength;this.CFColumnsLength=n,this.CFRowsLength=o;var l=this.getDataTable(i,n,o,a,r),c=l.dataTable,u=l.recordPosArray1,h=l.recordPosArray2;this.CFDataTable=c,this.recordCFPosArray1=u,this.recordCFPosArray2=h,this.CFDataSets=this.getDataSets(u,h,c,n,o)},getDataSets:function(t,e,a,r,i){var s=[];if(t.length!==e.length)return alert("时间字段有误或漏填，请确认格式"),null;for(var n=t.length,o=0;o<n;o++){t[o].target;for(var l=t[o].row,c=this.letterToNum(t[o].column),u=l+1;u<=i;u++)if(null!==a[c][u]){a[c][u];var h=c;while(1)if(h--,"string"===typeof a[h][u]){var d={};d.name=a[h][u],d.value1=a[c][u],d.value2=a[c+1][u],s.push(d);break}}}return s},getSheetSize:function(t){var e=t["!ref"],a=/^(\w*):(\w*)$/,r=a.exec(e)[1],i=a.exec(e)[2],s=/^([A-Z]*)([0-9]*)$/,n=s.exec(r)[1],o=s.exec(r)[2],l=s.exec(i)[1],c=s.exec(i)[2],u=l.charCodeAt(0)-n.charCodeAt(0)+1,h=q()(c,10)-q()(o,10)+1;return{columnsLength:u,rowsLength:h}},getDataTable:function(t,e,a,r,i){for(var s=[],n=[],o=[],l=1;l<=e;l++)s[l]=new Array(a+1);for(var c=1;c<=e;c++)for(var u=String.fromCharCode(c+64),h=1;h<=a;h++){var d=h,p=u+d.toString();t.hasOwnProperty(p)?(s[c][h]=t[p].v,"string"===typeof t[p].v&&-1!==t[p].v.indexOf(r)&&n.push({target:p,column:u,row:h}),"string"===typeof t[p].v&&-1!==t[p].v.indexOf(i)&&o.push({target:p,column:u,row:h})):s[c][h]=null}return{dataTable:s,recordPosArray1:n,recordPosArray2:o}},getSheetNames:function(t){this.paramSheetsArray=t.SheetNames},letterToNum:function(t){return t.charCodeAt(0)-64},close:function(){this.$emit("show-up-load")}}},ae=ee,re=(a("ba12"),Object(m["a"])(ae,Zt,Kt,!1,null,"57fe38e5",null)),ie=re.exports,se={name:"home-page",components:{CreateChartCom:Dt,UpLoadSheetCom:ie,ChartContainerCom:Wt,SideBarCom:tt,UpBarCom:nt,RightSideBarCom:Vt},data:function(){return{tableTitle:"2003年资产负债表",sheetsData:{ALMap:new u.a,PFMap:new u.a,CFMap:new u.a,ALGroup:[],PFGroup:[],CFGroup:[]},paramSheetsArray:{ALArray:[],PFArray:[],CFArray:[]},paramDataSets:{title:"资产负债表汇总",type:"group",group:"ALGroup"},leftStyleObj:{width:16.5,display:"block",flag:!0},isShowUpLoad:!1,tablesOrGroup:!0}},methods:{leftSlide:function(){var t=this;function e(){Z.a.update()&&requestAnimationFrame(e)}var a=new Z.a.Tween(this.leftStyleObj);16.5===this.leftStyleObj.width?a.to({width:1},100):a.to({width:16.5},100),a.start(),e(),setTimeout(function(){t.leftStyleObj.flag=!t.leftStyleObj.flag},100)},showUpLoad:function(){this.isShowUpLoad=!this.isShowUpLoad},changeTable:function(t,e){var a=/Group/;if(!0===a.test(e)){var r={title:t,type:"group",group:e};this.paramDataSets=r}else{var i={title:t,type:"table",group:e.replace(/Array/,"Map")};this.paramDataSets=i}},judgeTablesGroup:function(t){this.tablesOrGroup=-1!==t},collectData:function(t,e,a){var r=this.globalData;r.sheetsData.ALMap.set(t.name,{dataSets:t.dataSets,timeField1:t.timeField1,timeField2:t.timeField2,sheetTime:t.sheetTime,charts:[]}),r.sheetsData.PFMap.set(e.name,{dataSets:e.dataSets,timeField1:e.timeField1,timeField2:e.timeField2,sheetTime:e.sheetTime,charts:[]}),r.sheetsData.CFMap.set(a.name,{dataSets:a.dataSets,timeField1:a.timeField1,timeField2:a.timeField2,sheetTime:a.sheetTime,charts:[]}),this.dataToParaSheetsArray(t,"ALArray",this.paramSheetsArray),this.dataToParaSheetsArray(e,"PFArray",this.paramSheetsArray),this.dataToParaSheetsArray(a,"CFArray",this.paramSheetsArray)},showCreateChart:function(){this.isShowCreateChart=!this.isShowCreateChart},dataToParaSheetsArray:function(t,e,a){a[e].push({title:t.name,selected:!1,group:e})}}},ne=se,oe=(a("0889"),Object(m["a"])(ne,W,U,!1,null,"6bda032e",null)),le=oe.exports;h["default"].use(b["a"]);var ce=new b["a"]({mode:"hash",base:"",routes:[{path:"/",redirect:"/LoginPage"},{path:"/HomePage",name:"HomePage",component:le},{path:"/LoginPage",name:"LoginPage",component:H},{path:"/home",name:"home",component:k},{path:"/about",name:"about",component:function(){return a.e("about").then(a.bind(null,"f820"))}}]}),ue=a("bc3a"),he=a.n(ue),de=a("0c58"),pe=a.n(de),me=a("5c96"),ve=a.n(me),fe=(a("0fae"),a("313e")),ge=a.n(fe),be=a("659b");function Ce(t){var e=/^(\S+)=(\S+)$/,a=t.split("; "),r=new u.a,i=!0,s=!1,n=void 0;try{for(var o,c=l()(a);!(i=(o=c.next()).done);i=!0){var h=o.value,d=e.exec(h);r.set(d[1],d[2])}}catch(p){s=!0,n=p}finally{try{i||null==c.return||c.return()}finally{if(s)throw n}}return r}function ye(t){return JSON.parse(n()(t))}h["default"].config.productionTip=!1,h["default"].use(pe.a),h["default"].use(ve.a);var we=he.a.create({headers:{"Content-Type":"application/json"}});we.interceptors.request.use(function(t){return t.headers["X-CSRFToken"]=Ce(document.cookie).get("csrftoken"),t},function(t){return i.a.reject(t)}),we.interceptors.response.use(function(t){return t},function(t){}),h["default"].prototype.globalFunction={},h["default"].prototype.globalFunction.getCookieMap=Ce,h["default"].prototype.globalFunction.deepCopyByJSON=ye,h["default"].prototype.globalData={sheetsData:{ALMap:new u.a,PFMap:new u.a,CFMap:new u.a,ALGroup:[],PFGroup:[],CFGroup:[]}},h["default"].prototype.$axios=we,ge.a.registerTheme("Cat",be.theme),h["default"].prototype.$echarts=ge.a;var Ae=new h["default"]({router:ce,render:function(t){return t(g)}});Ae.$mount("#app")},"5e19":function(t,e,a){},"64a9":function(t,e,a){},"659b":function(t){t.exports={version:1,themeName:"customed",theme:{seriesCnt:3,backgroundColor:"rgba(252,252,252,0)",titleColor:"#516b91",subtitleColor:"#b3b3b3",textColorShow:!1,textColor:"#333",markTextColor:"#eee",color:["#f6b73f","#3f4566","#a1c9f9","#a0a7e6","#c4ebad","#96dee8"],borderColor:"#ccc",borderWidth:0,visualMapColor:["#bf444c","#d88273","#f6efa6"],legendTextColor:"#333",kColor:"#c23531",kColor0:"#314656",kBorderColor:"#c23531",kBorderColor0:"#314656",kBorderWidth:1,lineWidth:2,symbolSize:4,symbol:"emptyCircle",symbolBorderWidth:1,lineSmooth:!1,graphLineWidth:1,graphLineColor:"#aaa",mapLabelColor:"#000",mapLabelColorE:"rgb(100,0,0)",mapBorderColor:"#444",mapBorderColorE:"#444",mapBorderWidth:.5,mapBorderWidthE:1,mapAreaColor:"#eee",mapAreaColorE:"rgba(255,215,0,0.8)",axes:[{type:"all",name:"通用坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"category",name:"类目坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!1,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"value",name:"数值坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"log",name:"对数坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]},{type:"time",name:"时间坐标轴",axisLineShow:!0,axisLineColor:"#333",axisTickShow:!0,axisTickColor:"#333",axisLabelShow:!0,axisLabelColor:"#333",splitLineShow:!0,splitLineColor:["#ccc"],splitAreaShow:!1,splitAreaColor:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}],axisSeperateSetting:!0,toolboxColor:"#999",toolboxEmpasisColor:"#666",tooltipAxisColor:"#ccc",tooltipAxisWidth:1,timelineLineColor:"#293c55",timelineLineWidth:1,timelineItemColor:"#293c55",timelineItemColorE:"#a9334c",timelineCheckColor:"#e43c59",timelineCheckBorderColor:"rgba(194,53,49, 0.5)",timelineItemBorderWidth:1,timelineControlColor:"#293c55",timelineControlBorderColor:"#293c55",timelineControlBorderWidth:.5,timelineLabelColor:"#293c55",datazoomBackgroundColor:"rgba(47,69,84,0)",datazoomDataColor:"rgba(47,69,84,0.3)",datazoomFillColor:"rgba(167,183,204,0.4)",datazoomHandleColor:"#a7b7cc",datazoomHandleWidth:"100",datazoomLabelColor:"#333"}}},6860:function(t,e,a){},"68e7":function(t,e,a){},"6e6e":function(t,e,a){"use strict";var r=a("e6a2"),i=a.n(r);i.a},"897e":function(t,e,a){},"8d36":function(t,e,a){},b15f:function(t,e,a){},ba12:function(t,e,a){"use strict";var r=a("b15f"),i=a.n(r);i.a},bc11:function(t,e,a){"use strict";var r=a("5378"),i=a.n(r);i.a},bf3c:function(t,e,a){"use strict";var r=a("68e7"),i=a.n(r);i.a},ca17:function(t,e,a){"use strict";var r=a("5e19"),i=a.n(r);i.a},cf05:function(t,e,a){t.exports=a.p+"img/logo.a5acac0b.png"},e6a2:function(t,e,a){},f0d5:function(t,e,a){},f4ec:function(t,e,a){},f99f:function(t,e,a){"use strict";var r=a("f4ec"),i=a.n(r);i.a},fec0:function(t,e,a){}});
//# sourceMappingURL=app.7501c9e1.js.map